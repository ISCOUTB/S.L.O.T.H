$schema: https://moonrepo.dev/schemas/project.json

id: proto-js

project:
    name: proto-utils-js
    description: Shared utilities for working with protobufs in JavaScript/TypeScript projects.

toolchain:
    node:

tasks:
    generate:
        command: bash ./scripts/generate.sh
        options:
            runFromWorkspaceRoot: false
            cache: false

    pnpm:
        command: pnpm
        args:
            - --filter
            - "@etl-design/packages-proto-utils-js"
        options:
            runFromWorkspaceRoot: true
            cache: false

    prepare:
        command: noop
        deps:
            - eslint:build
        options:
            runDepsInParallel: true

    build:
        command: npx
        args:
            - tsup
        deps:
            - ^:generate
        options:
            runFromWorkspaceRoot: false
