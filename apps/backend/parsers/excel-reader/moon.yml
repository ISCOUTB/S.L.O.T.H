$schema: https://moonrepo.dev/schemas/project.json

project:
    name: Excel-Reader
    description: A FastAPI-based REST service that serves as the main entry point for the Excel Parsing system. This service processes Excel files, extracts formulas and data, and orchestrates communication with other microservices to generate SQL statements.

type: application

language: python

toolchain:
    python:
        version: "3.12.10"

tasks:
    test:
        command: uv
        args:
            - run
            - pytest
            - -v
            - -n
            - auto
            - --cov=src
            - --cov-report=term-missing
            - --cov-report=html
            - --cov-report=xml
        toolchain: python

    uv:
        command: uv
        toolchain: python
        options:
            runFromWorkspaceRoot: false
            cache: false

    run:
        command: uv
        args:
            - run
            - python
            - -m
            - src.server_rest
        toolchain: python
        local: true

    docker-build:
        command: docker
        args:
            - build
            - -t
            - excel-reader:1.0
            - -f
            - ./apps/backend/parsers/excel-reader/Dockerfile
            - .
        options:
            runFromWorkspaceRoot: true

